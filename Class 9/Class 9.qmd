---
title: "Class 9: sturctural Bioinfomatics"
author: "Iman Syed A18596789"
format: html
---



Download a CSV file from the PDB site (accessible from “Analyze” > “PDB Statistics” > “by Experimental Method and Molecular Type”. Move this CSV file into your RStudio project and use it to answer the following questions:

Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

```{r}
stats <- read.csv("Data Export Summary.csv")

stats

```
```{r}
stats$Total
```
Oh, these characters are not numeric

```{r}
as.numeric (sub(",", "", stats$Total))
```
```{r pdbstats, message=FALSE}
library(readr)
stats <- read_csv ("Data Export Summary.csv")
stats
```
```{r}
n.total <- sum(stats$Total)
n.total

```


Q2: What proportion of structures in the PDB are protein?

```{r}
n.xray <- sum (stats$`X-ray`)
percent.xray <- n.xray/n.total *100
percent.xray


```
```{r}
round(percent.xray, 2)
```

There are 'r round(precent.xray, 2') percent  Xray structures in the PDB

Final code chunk
```{r}
round(stats$Total [1]/n.total * 100, 2)

```


##Exploring PDB structures

Package structural bioinformatics

```{r}
library(bio3dview)

hiv <- read.pdb("1hsg")
hiv
```

Let's first use the Mol* viewer to explore this structure.

```{r}
head(hiv$atom)
```

Input structure images:




Exract sequence:
```{r}
pdbseq(hiv)
```



```{r}
chainA_seq <-pdbseq (trim.pdb(hiv, chain= "A"))
```



I can interactively view these PBD object---


(Some error due to computer)

```{r}
library(bio3dview)
view.pdb(hiv)
```





```{r}
sel <- atom.select(hiv, resno = 25)

view.pdb(hiv, highlight = sel,
         highlight.style = "spacefill",
         colorScheme = "chain",
         col=c("blue", "orange"),
         backgroundColor = "pink")
```







##Quick visualisation

using the : install.packages("pak")
            pak::pak("bioboot/bio3dview")
            install.packages("NGLVieweR")

We can run a bioninfomatics calculation to predict protein dynamics - i.e. functional motions.

We will use the 'nma()' function:

```{r}
adk <- read.pdb("6s36")
adk

```

```{r}
m <- nma(adk)
plot(m)
```




Generate a "trajectory" of a predicted motion

```{r}
mktrj (m, file = "ADK_nma.pdb")
```



```{r}

```











